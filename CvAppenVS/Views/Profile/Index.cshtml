@using CvAppen.Web.ViewModels
@using Microsoft.AspNetCore.Identity
@model MyProfileViewModel
@{
    ViewData["Title"] = "MinProfilSida";
}

<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="display-5 fw-normal">@Model.Name</h1>
        @if (Model.CanEditCv)
        {
            @if (Model.CV == null)
            {
                <a asp-controller="Cv" asp-action="Create" class="btn btn-dark rounded-pill px-4 shadow-sm">Skapa CV</a>
            }
            else
            {
                <a asp-controller="Cv" asp-action="Edit" asp-route-id="@Model.CV.Id" class="btn btn-outline-dark rounded-pill px-4 shadow-sm">Redigera CV</a>
            }
        }
    </div>

    @await Html.PartialAsync("_profilePartial", Model)
</div>

@*<div class="container mt-4">
@* RAD 1: Namn och Skapa/Redigera CV-knapp
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="display-5 fw-normal">@Model.Name</h1>

        @if (Model.CanEditCv)
        {
            @* Här hamnar knappen nu, precis som på din skiss
            @if (Model.CV == null)
            {
                <a asp-controller="Cv" asp-action="Create" class="btn btn-dark rounded-pill px-4 py-2 shadow-sm">
                    <i class="bi bi-plus-lg me-2"></i> Skapa CV
                </a>
            }
            else
            {
                <a asp-controller="Cv" asp-action="Edit" asp-route-id="@Model.CV.Id" class="btn btn-outline-dark rounded-pill px-4 py-2 shadow-sm">
                    <i class="bi bi-pencil-square me-2"></i> Redigera CV
                </a>
            }
        }
    </div>

@* RAD 2: Bild, Presentation och Kompetenser
    <div class="row">

@* Vänster: Grå bildbox
        <div class="col-md-4 mb-3">
            <div class="bg-light border d-flex align-items-center justify-content-center shadow-sm"
                 style="height: 350px; width: 100%; font-size: 2.5rem; color: #aaa; background-color: #f8f9fa;">
                @if (!string.IsNullOrEmpty(Model.ProfilePictureUrl))
                {
                    <img src="~/images/@Model.ProfilePictureUrl" class="img-fluid h-100 w-100" style="object-fit: cover;" alt="Profilbild">
                }
                else
                {
                    <span>Bild</span>
                }
            </div>
        </div>

        @* Höger: Text och Kompetenser 
        <div class="col-md-8 d-flex flex-column justify-content-between">
            <div>
                <p class="fs-5" style="line-height: 1.6; color: #333;">
                    @(Model.CV?.Presentation ?? "Här visas användarens presentationstext från deras CV.")
                </p>
            </div>

            @* Kompetens-sektionen 
            <div class="mt-4">
                <h5 class="text-center fw-bold mb-3">Kompetenser</h5>
                <div class="row">
                    <div class="col-6 text-end pe-4 border-end">
                        Java<br>C#<br>HTML/CSS
                    </div>
                    <div class="col-6 text-start ps-4 text-muted">
                        Fler kompetenser?<br>...<br>...
                    </div>
                </div>
            </div>
        </div>
    </div>

@* RAD 3: Listor för Utbildning, Projekt, erfarenhet 
    <div class="mt-5">
        <div class="mb-4">
            <h4 class="fw-bold pb-2 border-bottom">Utbildningar</h4>
            @if (Model.CV?.Educations != null && Model.CV.Educations.Any())
            {
                @foreach (var edu in Model.CV.Educations)
                {
                    <div class="mb-2">
                        <span class="fw-bold">@edu.School:</span> @edu.Name
                        <span class="text-muted small">(@edu.From - @edu.To)</span>
                    </div>
                }
            }
            else
            {
                <p class="text-muted">Information om utbildningar saknas.</p>
            }
        </div>

        <div class="mb-4">
            <h4 class="fw-bold pb-2 border-bottom">Tidigare erfarenheter</h4>
            @if (Model.CV?.EarlierExperiences != null && Model.CV.EarlierExperiences.Any())
            {
                @foreach (var exp in Model.CV.EarlierExperiences)
                {
                    <div class="mb-3">
                        <span class="fw-bold">@exp.Company:</span> @exp.Title
                        <div class="small text-muted">@exp.From - @exp.To</div>
                        <p class="mb-1">@exp.Description</p>
                    </div>
                }
            }
            else
            {
                <p class="text-muted">Inga tidigare erfarenheter listade.</p>
            }
        </div>

        <div class="mb-4">
            <h4 class="fw-bold pb-2 border-bottom">Projekt</h4>
            @if (Model.MyProjects != null && Model.MyProjects.Any())
            {
                @foreach (var project in Model.MyProjects)
                {
                    <div class="mb-3">
                        <span class="fw-bold">@project.Title:</span> @project.Title
                    </div>
                }
            }
            else
            {
                <p class="text-muted">Inga listade projekt hittades.</p>
            }
        </div>

       @* <div class="mb-4">
            <h4 class="fw-bold pb-2 border-bottom">Tidigare erfarenheter</h4>
            <p>@(Model.CV?.EarlierExperience ?? "Inga tidigare erfarenheter listade.")</p>
        </div>*@

@* lägg in User-info som inte är kopplat till CV

@if (Model.CV == null) //&& Model.CanEditCv)
{
    <div class="alert alert-info">
        @(Model.CanEditCv ? "Har inget CV ännu." : "Inget CV publicerat ännu")
    </div>
    @if (Model.CanEditCv)
    {
        <a asp-controller="Cv" asp-action="Create" class="btn btn-primary">
            Skapa CV
        </a>
    }
}

else 
{ 
    <div class="profile-cv">
        <h2>CV</h2>
        @await Html.PartialAsync("_CvPartial", Model.CV)
    </div>   
    
    @if (!Model.CanEditCv)
    {
        <a asp-controller="Message" asp-action="Add"
           asp-route-toUserId="@Model.UserId"
           class="btn btn-outline-primary ms-2"> Skicka ett meddelande </a>
    }

   
    @if (Model.CanEditCv)
    {
        <a asp-controller="Cv" asp-action="Edit" asp-route-id="@Model.CV.Id" class="btn btn-primary">
            Redigera CV
        </a>
    }
}

<h3>Projekt</h3>
@if (Model.MyProjects != null && Model.MyProjects.Any())
{
    <ul>
        @foreach(var project in Model.MyProjects)
        {
            <li>@project.Title</li>
        }
    </ul>
} 
else
{
    <div>Inga projekt ännu.</div>
}*@




